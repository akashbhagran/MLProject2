// Jenkinsfile (Declarative Pipeline)

pipeline {
    agent any
     
    stages {
    	
    	stage('Hello') { 
            steps {
            	// hello world
                echo 'hello world'
            }
        }
        
        stage('Unit Test') {
      	    steps{
            	withPythonEnv('python3') {
                	sh 'pip install -r requirements.txt'
                	sh 'python3 --version'
                	sh '. /app/venv/bin/activate'
                	sh 'pytest'
            	}
            }
        }
        
        stage('Build') { 
            steps {
       		  sh 'docker build -t myimage .'
       		  sh 'docker run -it --rm myimage bash -c "python --version"'

            }S
        }
 
    }
}                                                                                                                                                        
